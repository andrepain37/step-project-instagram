(this["webpackJsonpstep-project"]=this["webpackJsonpstep-project"]||[]).push([[0],{167:function(e,t,a){},290:function(e,t,a){"use strict";a.r(t);var n=a(2),c=a(0),s=a.n(c),r=a(12),o=a.n(r),i=(a(167),a(168),a(354)),l=a(9),u=a(338),d=a(151),j=a(337),b=a(339);var O=function(){return Object(n.jsxs)("div",{className:"logo",children:[Object(n.jsx)("span",{className:"logo-left logo-side",children:"Mono"}),Object(n.jsx)("span",{className:"logo-right logo-side",children:"Photos"})]})},m=a(8),p=a(19),f=a.n(p),h=a(16),x=a.n(h),g=function(){return function(e,t){var a=t().posts,n=a.posts,c=a.page;a.hasMore&&x.a.post("/posts",{page:c}).then((function(t){t.data?e(function(e){return{type:"LOAD_POSTS",payload:e}}(n.concat(t.data))):e(function(e){return{type:"SAVE_HAS_MORE",payload:e}}(!1))}))}},v=function(e){return function(t){t(function(e){return function(t,a){x.a.post("/posts/one",{postId:e}).then((function(e){e.data&&t({type:"ACTIVATE_POST",payload:e.data})}))}}(e)),t({type:"ACTIVE_POST_DETAILS"})}},y=a(6),_=function(e){return{type:"SEND_LOGIN",payload:e}},S=a(357),E=a(48);var L=function(){var e=Object(m.c)();Object(c.useEffect)((function(){e((function(e,t){t().user.isAuth&&x.a.post("/auth/check",{withCredentials:!0}).then((function(t){t.data?e(_(t.data.user)):e({type:"SEND_LOGOUT"})}))}))}),[e]);var t=Object(c.useState)(null),a=Object(l.a)(t,2),s=a[0],r=a[1],o=function(){r(null)},i=Object(m.d)((function(e){return e.user.isLogin})),p=Object(m.d)((function(e){return e.user.user_info}));return Object(n.jsxs)("header",{children:[Object(n.jsx)(E.b,{to:"/",children:Object(n.jsx)(O,{})}),Object(n.jsxs)("div",{className:"header-nav-info",children:[i&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(S.a,{"aria-label":"recipe",src:p.image,className:"avatar",children:p.nickname[0]}),Object(n.jsxs)(d.a,{id:"simple-menu",anchorEl:s,keepMounted:!0,open:!!s,onClose:o,children:[Object(n.jsx)(j.a,{onClick:function(){r(null),e((function(e){e({type:"ACTIVE_UPLOAD_USER_AVATAR"})}))},children:"\u041f\u043e\u043c\u0435\u043d\u044f\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440"}),Object(n.jsx)(j.a,{onClick:function(){r(null),e((function(e){e({type:"ACTIVE_UPLOAD_POST"})}))},children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043f\u043e\u0441\u0442"}),Object(n.jsx)(j.a,{onClick:function(){r(null),e((function(e){x.a.post("/auth/logout").then((function(){e({type:"SEND_LOGOUT"}),e({type:"DELETE_POSTS"}),e({type:"CLEAR_SUBS"})}))}))},children:"\u0412\u044b\u0439\u0442\u0438"})]})]}),!i&&Object(n.jsxs)(d.a,{id:"simple-menu",anchorEl:s,keepMounted:!0,open:!!s,onClose:o,children:[Object(n.jsx)(j.a,{onClick:function(){r(null),e((function(e){e({type:"ACTIVE_LOGIN"})}))},children:"\u0412\u043e\u0439\u0442\u0438"}),Object(n.jsx)(j.a,{onClick:function(){r(null),e((function(e){e({type:"ACTIVE_REGISTER"})}))},children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(n.jsx)(u.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){r(e.currentTarget)},children:Object(n.jsx)(b.a,{})})]})]})},A=a(31),C=a(24),k=/\S+@\S+\.\S+/,N="\u041f\u043e\u043b\u0435 \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c",T=C.a().shape({nickname:C.c().required(N).min(3,"\u0423 \u043d\u0438\u043a\u043d\u0435\u0439\u043c\u0430 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 3 \u0441\u0438\u043c\u0432\u043e\u043b\u0430").max(20,"\u0423 \u043d\u0438\u043a\u043d\u0435\u0439\u043c\u0430 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 20 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),email:C.c().required(N).matches(k,"\u0412\u0432\u0435\u0434\u0435\u043d\u043d\u044b\u0439 Email \u043d\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439!"),password:C.c().required(N),repeat:C.c().required(N).oneOf([C.b("password"),null],"\u041f\u0430\u0440\u043e\u043b\u0438 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442!")}),I=a(292),w=a(152),D=a(355);var P=function(e){var t=e.label,a=e.name,c=e.classes,s=Object(w.a)(e,["label","name","classes"]),r=Object(A.b)(a),o=Object(l.a)(r,2),i=o[0],u=o[1];return Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(D.a,Object(y.a)(Object(y.a)({id:"outlined-password-input",error:u.touched&&!!u.error,label:t,name:a,helperText:u.touched&&u.error,className:c},i),s))})};var V=Object(m.b)(null,(function(e){return{sendReg:function(t){return e(function(e){var t=e.values,a=e.setError;return function(e){x.a.post("/auth/register",Object(y.a)({},t)).then((function(t){if(t.data.error)for(var n in t.data.error)a(n,t.data.error[n]),f.a.error(t.data.error[n]);t.data.success&&(e((function(e,t){var a=t().modals;for(var n in a)a[n]=!1;e({type:"CLOSE_ALL",payload:a})})),f.a.success(t.data.success))}))}}(t))}}}))(Object(A.c)({mapPropsToValues:function(){return{nickname:"",email:"",password:"",repeat:""}},handleSubmit:function(e,t){var a=t.props,n={values:e,setError:t.setFieldError};a.sendReg(n)},validationSchema:T})((function(){return Object(n.jsx)(I.a,{children:Object(n.jsxs)(A.a,{noValidate:!0,autoComplete:"off",className:"modal-form",children:[Object(n.jsx)("h3",{className:"modal-form-title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(n.jsx)(P,{label:"\u0412\u0430\u0448 \u043d\u0438\u043a\u043d\u0435\u0439\u043c",name:"nickname",type:"text"}),Object(n.jsx)(P,{label:"\u0412\u0430\u0448 email",name:"email",type:"text"}),Object(n.jsx)(P,{label:"\u0412\u0430\u0448 \u043f\u0430\u0440\u043e\u043b\u044c",name:"password",type:"password"}),Object(n.jsx)(P,{label:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",name:"repeat",type:"password"}),Object(n.jsx)(u.a,{color:"primary",type:"submit",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})})}))),M="\u041f\u043e\u043b\u0435 \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c",R=C.a().shape({email:C.c().required(M).matches(k,"\u0412\u0432\u0435\u0434\u0435\u043d\u043d\u044b\u0439 Email \u043d\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439!"),password:C.c().required(M)});var U=Object(m.b)(null,(function(e){return{sendLog:function(t){return e(function(e){var t=e.values,a=e.setError;return function(e){x.a.post("/auth/login",Object(y.a)({},t)).then((function(t){if(t.data.error)for(var n in t.data.error)a(n,t.data.error[n]),f.a.error(t.data.error[n]);t.data.success&&(e((function(e,t){var a=t().modals;for(var n in a)a[n]=!1;e({type:"CLOSE_ALL",payload:a})})),e(_(t.data.user)),f.a.success(t.data.success),e({type:"DELETE_POSTS"}))}))}}(t))}}}))(Object(A.c)({mapPropsToValues:function(){return{email:"",password:""}},handleSubmit:function(e,t){var a=t.props,n={values:e,setError:t.setFieldError};a.sendLog(n)},validationSchema:R})((function(){return Object(n.jsx)(I.a,{children:Object(n.jsxs)(A.a,{noValidate:!0,autoComplete:"off",className:"modal-form",children:[Object(n.jsx)("h3",{className:"modal-form-title",children:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"}),Object(n.jsx)(P,{label:"\u0412\u0430\u0448 email",name:"email",type:"text"}),Object(n.jsx)(P,{label:"\u0412\u0430\u0448 \u043f\u0430\u0440\u043e\u043b\u044c",name:"password",type:"password"}),Object(n.jsx)(u.a,{color:"primary",type:"submit",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})})}))),B=a(340),G=a(341);var F=function(){var e=Object(m.d)((function(e){return e.user.isLogin})),t=Object(c.useState)(null),a=Object(l.a)(t,2),s=a[0],r=a[1],o=Object(c.useState)(null),i=Object(l.a)(o,2),d=i[0],j=i[1],b=Object(m.c)(),O=Object(c.useRef)(null);return e?Object(n.jsxs)(I.a,{children:[Object(n.jsx)("h3",{className:"modal-form-title",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043f\u043e\u0441\u0442!"}),Object(n.jsxs)("div",{className:"modal-form-post",children:[Object(n.jsx)(u.a,{onClick:function(){O.current.click()},variant:"contained",color:"default",startIcon:Object(n.jsx)(B.a,{}),children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"}),Object(n.jsx)("input",{ref:O,style:{display:"none"},name:"upload_post",id:"upload_post",type:"file",onChange:function(e){var t=window.URL.createObjectURL(e.target.files[0]);r(e.target.files[0]),j(t)}}),d&&s&&Object(n.jsxs)("div",{className:"modal-form-post__preview",children:[Object(n.jsx)(u.a,{variant:"contained",color:"primary",startIcon:Object(n.jsx)(G.a,{}),onClick:function(){b(function(e){return function(){var t=new FormData;t.append("image_upload",e),x.a.post("/posts/create",t,{headers:{"Content-Type":"multipart/form-data;boundary=1"}}).then((function(e){e.data&&e.data.success&&f.a.success(e.data.success)}))}}(s)),r(null),j(null)},children:"\u0412\u044b\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043f\u043e\u0441\u0442!"}),Object(n.jsx)("hr",{}),Object(n.jsx)("h4",{children:"\u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440!"}),Object(n.jsx)("img",{src:d,alt:s.name})]})]})]}):"Error"};var q=function(){var e=Object(m.d)((function(e){return e.user.isLogin})),t=Object(c.useState)(null),a=Object(l.a)(t,2),s=a[0],r=a[1],o=Object(c.useState)(null),i=Object(l.a)(o,2),d=i[0],j=i[1],b=Object(m.c)(),O=Object(c.useRef)(null);return e?Object(n.jsxs)(I.a,{children:[Object(n.jsx)("h3",{className:"modal-form-title",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440!"}),Object(n.jsxs)("div",{className:"modal-form-post",children:[Object(n.jsx)(u.a,{onClick:function(){O.current.click()},variant:"contained",color:"default",startIcon:Object(n.jsx)(B.a,{}),children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"}),Object(n.jsx)("input",{ref:O,style:{display:"none"},name:"upload_post",id:"upload_post",type:"file",onChange:function(e){var t=window.URL.createObjectURL(e.target.files[0]);r(e.target.files[0]),j(t)}}),d&&s&&Object(n.jsxs)("div",{className:"modal-form-post__preview",children:[Object(n.jsx)(u.a,{variant:"contained",color:"primary",startIcon:Object(n.jsx)(G.a,{}),onClick:function(){b(function(e){return function(t,a){if(a().user.isLogin){var n=new FormData;n.append("image_upload",e),x.a.post("/users/image/set",n,{headers:{"Content-Type":"multipart/form-data;boundary=1"}}).then((function(e){e.data&&e.data.success&&e.data.image&&(f.a.success(e.data.success),t({type:"SET_AVATAR",payload:e.data.image}),t((function(e,t){var a=t().modals;for(var n in a)a[n]=!1;e({type:"CLOSE_ALL",payload:a})})))}))}else f.a.error("\u0412\u044b \u043d\u0435 \u0432\u043e\u0448\u043b\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442!")}}(s)),r(null),j(null)},children:"\u041f\u043e\u043c\u0435\u043d\u044f\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440!"}),Object(n.jsx)("hr",{}),Object(n.jsx)("h4",{children:"\u041f\u0440\u0435\u0434\u0432\u0430\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440!"}),Object(n.jsx)("img",{src:d,alt:s.name})]})]})]}):"Error"},H=a(356),W=a(342),Y=C.a().shape({add_comment:C.c().required("\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439 \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c").min(1,"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439 \u043d\u0435 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c")});var z=Object(m.b)(null,(function(e){return{sendComment:function(t,a){return e(function(e){var t=e.postId,a=e.comment,n=e.resetValue;return function(e,c){var s=c().user,r=s.isLogin,o=s.user_info;r?x.a.post("/posts/comment",{postId:t,comment:a}).then((function(c){c.data&&(c.data.success&&(f.a.success(c.data.success),e({type:"SAVE_LAST_COMMENT",payload:{postId:t,newComment:{comment:a,name:o.nickname,id:c.data.id}}}),n()),c.data.error&&f.a.error(c.data.error))})):f.a.error("\u0412\u044b \u043d\u0435 \u0432\u043e\u0448\u043b\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442")}}(t))}}}))(Object(A.c)({mapPropsToValues:function(){return{add_comment:""}},handleSubmit:function(e,t){var a=t.props,n=t.resetForm,c={postId:a.postId,comment:e.add_comment,resetValue:n};a.sendComment(c)},validationSchema:Y})((function(e){var t=e.lastComments,a=e.postId,s=void 0!==a&&a,r=e.isAllComments,o=void 0!==r&&r,i=Object(c.useState)(o),d=Object(l.a)(i,2),j=d[0],b=d[1],O=Object(m.c)(),p=!1;return t&&(p=t.map((function(e){return Object(n.jsxs)("div",{className:"comments-comment",children:[Object(n.jsx)("span",{className:"comments-comment--name",children:e.name}),Object(n.jsx)("span",{className:"comments-comment--comment",children:e.comment})]},e.id)}))),Object(n.jsxs)("section",{className:"comments",children:[!j&&t&&Object(n.jsx)("span",{onClick:function(){b(!0),O(function(e){return function(t){x.a.post("/posts/comments",{postId:e}).then((function(a){a.data&&a.data.comments&&t({type:"SAVE_ALL_COMMENTS",payload:{comments:a.data.comments,postId:e}})}))}}(s))},className:"comments-loader",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0432\u0441\u0435 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438"}),Object(n.jsx)("div",{className:"comments_users",children:p}),Object(n.jsxs)(A.a,{noValidate:!0,autoComplete:"off",className:"comments-form",children:[Object(n.jsx)(P,{label:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",name:"add_comment",type:"text",classes:"comments-form__comment"}),Object(n.jsx)(u.a,{color:"primary",type:"submit",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})]})}))),J=a(63),X=a(4),$=a(343),K=a(344),Q=a(346),Z=a(345),ee=a(348),te=a(347),ae=a(66),ne=a.n(ae),ce=a(96),se=a.n(ce);a(288);var re=Object(W.a)((function(e){return{"@keyframes likeOnBg-anim":{"0%":{opacity:0,transform:"translate(-50%, -50%) scale(1)"},"100%":{opacity:1,transform:"translate(-50%, -50%) scale(3)"}},card:{marginBottom:"20px"},media:{height:0,paddingTop:"100%",cursor:"pointer"},like:{transition:".3s"},likeOnBg:{transition:".2s",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%) scale(1)",pointerEvents:"none",color:"#ff3b3bc2",opacity:0},likeOnBgActive:{animation:"$likeOnBg-anim 200ms linear",transform:"translate(-50%, -50%) scale(3)",opacity:1},likeActive:{color:"#ff3b3b"},content:{padding:0,position:"relative"},formodal:{flex:1}}}));function oe(e){var t=e.id,a=e.likes,r=e.image,o=e.user,i=e.liked,u=e.children,d=e.date,j=e.props_classes,b=se()(d).format("DD MMMM YYYY HH:mm"),O=re(),p=Object(m.c)(),h=Object(m.d)((function(e){return e.user.isLogin})),g=s.a.useState(i),v=Object(l.a)(g,2),y=v[0],_=v[1],E=s.a.useState(!1),L=Object(l.a)(E,2),A=L[0],C=L[1],k=s.a.useState(a),N=Object(l.a)(k,2),T=N[0],I=N[1];Object(c.useEffect)((function(){if(A){var e=setInterval((function(){C(!1)}),1500);return function(){return clearInterval(e)}}}),[A]);var w=function(e){var a,n;h&&I(e?T-1:T+1),p((a=t,n=!e,function(e,t){t().user.isLogin?x.a.post("/posts/like",{postId:a,isLike:n}).then((function(e){e.data&&e.data.error&&f.a.error(e.data.error)})):f.a.error("\u0412\u044b \u043d\u0435 \u0432\u043e\u0448\u043b\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442!")}))};return Object(n.jsxs)($.a,{className:[O.card,j].join(" "),children:[Object(n.jsxs)("div",{className:O.formodal,children:[Object(n.jsx)(K.a,{avatar:Object(n.jsx)(S.a,{"aria-label":"recipe",src:o.image,className:"avatar",children:o.nickname[0]}),title:o.nickname,subheader:b}),Object(n.jsxs)(Z.a,{className:O.content,children:[Object(n.jsx)(Q.a,{className:O.media,onDoubleClick:function(){h&&(!0!==y&&w(y,!0),_(!0),C(!0))},image:r}),Object(n.jsx)(te.a,{className:Object(X.a)(O.likeOnBg,Object(J.a)({},O.likeOnBgActive,A)),children:Object(n.jsx)(ne.a,{})})]}),Object(n.jsxs)(ee.a,{disableSpacing:!0,children:[Object(n.jsx)(te.a,{"aria-label":"add to favorites",className:Object(X.a)(O.like,Object(J.a)({},O.likeActive,y)),onClick:function(){h&&_(!y),w(y)},"aria-expanded":y,children:Object(n.jsx)(ne.a,{})}),Object(n.jsxs)("span",{children:[T,' \u043e\u0442\u043c\u0435\u0442\u043e\u043a "\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f"']})]})]}),Object(n.jsx)(ee.a,{className:O.formodal,disableSpacing:!0,children:u})]})}var ie=function(){return Object(n.jsx)("div",{className:"loader",children:Object(n.jsxs)("svg",{viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",children:[Object(n.jsx)("circle",{cx:"50",cy:"50",r:"32",strokeWidth:"8",stroke:"#000000",strokeDasharray:"50.26548245743669 50.26548245743669",fill:"none",strokeLinecap:"round",children:Object(n.jsx)("animateTransform",{attributeName:"transform",type:"rotate",dur:"1s",repeatCount:"indefinite",keyTimes:"0;1",values:"0 50 50;360 50 50"})}),Object(n.jsx)("circle",{cx:"50",cy:"50",r:"23",strokeWidth:"8",stroke:"#d0d0d0",strokeDasharray:"36.12831551628262 36.12831551628262",strokeDashoffset:"36.12831551628262",fill:"none",strokeLinecap:"round",children:Object(n.jsx)("animateTransform",{attributeName:"transform",type:"rotate",dur:"1s",repeatCount:"indefinite",keyTimes:"0;1",values:"0 50 50;-360 50 50"})})]})})},le=Object(W.a)((function(e){return{wrap:{display:"flex"}}}));var ue=function(){var e=Object(c.useState)(!0),t=Object(l.a)(e,2),a=t[0],s=t[1],r=Object(m.d)((function(e){return e.posts.activePostDetails})),o=le();return Object(c.useEffect)((function(){r&&s(!1)}),[r]),a?Object(n.jsx)(ie,{}):Object(n.jsx)(oe,Object(y.a)(Object(y.a)({},r),{},{props_classes:o.wrap,children:Object(n.jsx)(z,{postId:r.id,lastComments:r.lastComments,isAllComments:!0})}))},de=Object(W.a)((function(e){return{paper:{position:"absolute",background:"linear-gradient(135deg, #000 50%, #fff 50%)",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),width:"100%",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}}));function je(){var e=Object(m.c)(),t=Object(m.d)((function(e){return e.modals.active})),a=Object(m.d)((function(e){return e.modals.register})),c=Object(m.d)((function(e){return e.modals.login})),s=Object(m.d)((function(e){return e.modals.uploadPost})),r=Object(m.d)((function(e){return e.modals.uploadUserAvatar})),o=Object(m.d)((function(e){return e.modals.postDetails})),i=de(),l={maxWidth:400};o&&(l.maxWidth=1e3,l.maxHeight=660);var u=function(t){e((function(e,t){var a=t().modals;for(var n in a)a[n]=!1;e({type:"CLOSE_ALL",payload:a})})),t&&e({type:"DEL_ACTIVATE_POST"})};return Object(n.jsx)(H.a,{open:t,onClose:function(){return u(o)},children:Object(n.jsx)(I.a,{className:i.paper,style:Object(y.a)({},l),children:Object(n.jsxs)("section",{className:"modal",children:[Object(n.jsx)("span",{className:"modal__close",onClick:u}),a&&Object(n.jsx)(V,{}),c&&Object(n.jsx)(U,{}),s&&Object(n.jsx)(F,{}),r&&Object(n.jsx)(q,{}),o&&Object(n.jsx)(ue,{})]})})})}var be=Object(c.memo)(je),Oe=a(15),me=a(146),pe=a(336),fe=a(45),he=function(e,t,a){return function(n,c){var s=c().user.isLogin,r=t?"unsub":"sub";s&&e&&x.a.post("/subs/action/".concat(r),{userId:e}).then((function(e){e.data&&(e.data.error&&f.a.error(e.data.error),e.data.sub&&a(!t))}))}},xe=a(293),ge=a(351),ve=a(350),ye=a(349),_e=a(147),Se=a.n(_e),Ee=a(148),Le=a.n(Ee),Ae=Object(W.a)((function(){return{button:{minWidth:"inherit"},link:{width:"100%",display:"flex",alignItems:"center"}}})),Ce=function(e){var t,a,s=e.image,r=e.nickname,o=e.togglePoint,i=e._id,d=e.isSubs,j=Object(c.useState)(d||!1),b=Object(l.a)(j,2),O=b[0],p=b[1],f=Ae(),h=Object(m.c)();O?(t="\u041e\u0442\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f",a=Object(n.jsx)(Le.a,{})):(t="\u041f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f",a=Object(n.jsx)(Se.a,{}));return Object(n.jsxs)(xe.a,{button:!0,children:[Object(n.jsxs)(E.b,{className:f.link,to:"/user/".concat(i),children:[Object(n.jsx)(ye.a,{children:Object(n.jsx)(S.a,{"aria-label":"recipe",src:s,className:"avatar",children:r[0]})}),Object(n.jsx)(ve.a,{primary:r})]}),Object(n.jsx)(ge.a,{children:Object(n.jsxs)(u.a,{onClick:function(){h(he(i,O,p))},variant:"contained",className:f.button,color:"secondary",children:[!o&&t,o&&a]})})]})},ke=Object(W.a)((function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper,border:"1px solid #000",marginBottom:"5px",maxHeight:"140px",overflowX:"auto"}}}));var Ne=function(e){var t=e.togglePoint,a=ke(),s=Object(m.c)(),r=Object(m.d)((function(e){return e.subs.user_subs})),o=Object(m.d)((function(e){return e.subs.isLoadingSub})),i=Object(m.d)((function(e){return e.user.isLogin}));Object(c.useEffect)((function(){!r.length&&o&&s((function(e,t){t().user.isLogin&&x.a.post("/subs/get").then((function(t){t.data&&t.data.subs&&e({type:"SAVE_SUBS",payload:t.data.subs})}))}))}),[s,r,o,i]);var l=r.map((function(e){return Object(n.jsx)(Ce,Object(y.a)({isSubs:!0,togglePoint:t},e),e._id)}));return!r.length&&o?Object(n.jsx)(ie,{}):Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(fe.a,{variant:"h6",children:"\u0412\u0430\u0448\u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0438:"}),Object(n.jsxs)(pe.a,{dense:!0,className:a.root,children:[l,!o&&!r.length&&Object(n.jsx)("p",{className:"center",children:"\u0412\u044b \u043d\u0438\u043d\u0430\u043a\u043e\u0433\u043e \u043d\u0435 \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u044b :("})]})]})},Te=Object(W.a)((function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper,border:"1px solid #000",marginBottom:"5px",maxHeight:"140px",overflowX:"auto"}}}));var Ie=function(e){var t=e.togglePoint,a=Te(),s=Object(m.c)(),r=Object(m.d)((function(e){return e.subs.recomends_subs})),o=Object(m.d)((function(e){return e.subs.isLoadingRec})),i=Object(m.d)((function(e){return e.user.isLogin}));Object(c.useEffect)((function(){!r.length&&o&&s((function(e,t){t().user.isLogin&&x.a.post("/subs/recomends").then((function(t){t.data&&t.data.subs&&e({type:"GET_RECOMEND_SUBS",payload:t.data.subs})}))}))}),[s,r,o,i]);var l=r.map((function(e){return Object(n.jsx)(Ce,Object(y.a)({togglePoint:t},e),e._id)}));return!r.length&&o?Object(n.jsx)(ie,{}):Object(n.jsx)(n.Fragment,{children:!o&&!!r.length&&Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(fe.a,{variant:"h6",children:"\u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c\u044b\u0435:"}),Object(n.jsx)(pe.a,{dense:!0,className:a.root,children:l})]})})},we=function(e){var t=Object(c.useState)(null),a=Object(l.a)(t,2),n=a[0],s=a[1];return Object(c.useEffect)((function(){var t={},a=Object.keys(e),n=!1,c=function(){var e=a.reduce((function(e,a){return e[a]=!(!t[a]||!t[a].matches),e}),{});s(e)};if(window&&window.matchMedia){var r={};a.forEach((function(a){"string"===typeof e[a]?(t[a]=window.matchMedia(e[a]),r[a]=t[a].matches):r[a]=!1})),s(r),n=!0,a.forEach((function(a){"string"===typeof e[a]&&t[a].addListener(c)}))}return function(){n&&a.forEach((function(a){"string"===typeof e[a]&&t[a].removeListener(c)}))}}),[e]),n};var De=function(e){var t=e.queries,a=Object(m.c)(),s=Object(m.d)((function(e){return e.posts.posts})),r=Object(m.d)((function(e){return e.posts.hasMore})),o=Object(m.d)((function(e){return e.user.isLogin}));Object(c.useEffect)((function(){s.length||a(g())}),[s,a]);var i=s.map((function(e,t){return Object(n.jsx)(oe,Object(y.a)(Object(y.a)({},s[t]),{},{children:Object(n.jsx)(z,{lastComments:e.lastComment,postId:e.id})}),e.id)})),l=we(t);return Object(n.jsxs)("section",{className:"home-container",children:[Object(n.jsx)("div",{className:"posts".concat(o?"":"-max"),children:Object(n.jsx)(me.a,{dataLength:s.length,next:function(){return a(g())},hasMore:r,endMessage:Object(n.jsx)("p",{className:"center",children:"\u041f\u043e\u0441\u0442\u043e\u0432 \u043d\u0435\u0442\u0443 :("}),loader:Object(n.jsx)(ie,{}),children:i})}),o&&Object(n.jsxs)("div",{className:"subs",children:[Object(n.jsx)(Ne,{togglePoint:!!l&&l.toggle}),Object(n.jsx)(Ie,{togglePoint:!!l&&l.toggle})]})]})},Pe=a(353),Ve=a(149),Me=a.n(Ve),Re=a(352),Ue=Object(W.a)((function(e){return{root:{height:"auto"}}}));var Be=function(e){var t=Ue();return Object(n.jsx)(Re.a,Object(y.a)(Object(y.a)({},e),{},{style:Object(y.a)(Object(y.a)({},e.style),{},{height:"auto",padding:"5px"}),className:t.root}))},Ge=Object(W.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",backgroundColor:e.palette.background.paper},img:{width:"100%",maxHeight:"280px",height:"100%"},list:{width:"100%"},details:{position:"absolute",background:"#1a191991",zIndex:1,width:"100%",height:"100%",top:0,left:0,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",color:"#fff",fontSize:"20px",transition:".3s",opacity:0,cursor:"pointer","&:hover":{opacity:1}}}}));var Fe=function(e){var t=e.userId,a=Ge(),s=Object(c.useState)([]),r=Object(l.a)(s,2),o=r[0],i=r[1],u=Object(c.useState)(!0),d=Object(l.a)(u,2),j=d[0],b=d[1],O=Object(m.c)();return Object(c.useEffect)((function(){!function(e){x.a.post("/users/posts",{userId:e}).then((function(e){e.data&&(e.data.error&&f.a.error(e.data.error),e.data.posts&&(i(e.data.posts),b(!1)))}))}(t)}),[t]),j?Object(n.jsx)(ie,{}):Object(n.jsxs)("div",{className:a.root,children:[!!o.length&&Object(n.jsx)(Pe.a,{cols:3,className:a.list,children:o.map((function(e){return Object(n.jsxs)(Be,{cols:1,onClick:function(){return t=e._id,void O(v(t));var t},children:[Object(n.jsxs)("div",{className:a.details,children:[Object(n.jsxs)("span",{children:[e.likes,Object(n.jsx)(ne.a,{})]}),Object(n.jsxs)("span",{children:[e.comments,Object(n.jsx)(Me.a,{}),"   "]})]}),Object(n.jsx)("img",{className:a.img,src:e.image,alt:"Post \u2116"+e._id})]},e._id)}))}),!o.length&&"\u0423 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0435\u0449\u0451 \u043d\u0435\u0442 \u043f\u043e\u0441\u0442\u043e\u0432!"]})},qe=Object(W.a)((function(e){return{header:{width:"100%",backgroundColor:e.palette.background.paper,marginBottom:"5px",display:"flex"},avatar:{width:"100px",height:"100px",fontSize:"40px"},second:{marginLeft:"30px"}}}));var He=function(e){var t=e.userId,a=Object(c.useState)([]),s=Object(l.a)(a,2),r=s[0],o=s[1],i=Object(c.useState)(!0),d=Object(l.a)(i,2),j=d[0],b=d[1],O=Object(c.useState)(!1),p=Object(l.a)(O,2),h=p[0],g=p[1];Object(c.useEffect)((function(){!function(e){x.a.post("/subs/info",{userId:e}).then((function(e){e.data&&(e.data.error&&f.a.error(e.data.error),e.data.info&&(o(e.data.info),g(e.data.info.isSub),b(!1)))}))}(t)}),[t]);var v,y=r.nickname,_=r.image,E=qe(),L=Object(m.c)();return j?Object(n.jsx)(ie,{}):(v=h?"\u041e\u0442\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f":"\u041f\u043e\u0434\u043f\u0438\u0441\u0430\u0442\u044c\u0441\u044f",Object(n.jsxs)("section",{className:E.header,children:[Object(n.jsx)(S.a,{"aria-label":"recipe",src:_,className:"avatar ".concat(E.avatar),children:y[0]}),Object(n.jsxs)("div",{className:E.second,children:[Object(n.jsx)(fe.a,{variant:"h3",children:y}),Object(n.jsx)(u.a,{variant:"contained",color:"secondary",onClick:function(){L(he(t,h,g))},children:v})]})]}))};var We=function(e){var t=e.match.params.userId;return Object(n.jsxs)("section",{className:"user-container",children:[Object(n.jsx)(He,{userId:t}),Object(n.jsx)(Fe,{userId:t})]})},Ye={toggle:"(max-width: 930px)"},ze=function(){return Object(n.jsxs)(Oe.c,{children:[Object(n.jsx)(Oe.a,{exact:!0,path:"/",children:Object(n.jsx)(De,{queries:Ye})}),Object(n.jsx)(Oe.a,{exact:!0,path:"/user/:userId",component:We})]})},Je=function(){return Object(n.jsxs)(i.a,{maxWidth:"md",children:[Object(n.jsx)(L,{}),Object(n.jsx)(ze,{}),Object(n.jsx)(be,{})]})},Xe=a(44),$e={posts:[],page:1,hasMore:!0,activePostDetails:null},Ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_POSTS":return Object(y.a)(Object(y.a)({},e),{},{posts:t.payload,page:e.page+1});case"UPLOAD_IMAGE":return Object(y.a)(Object(y.a)({},e),{},{selectedFile:null});case"SAVE_HAS_MORE":return Object(y.a)(Object(y.a)({},e),{},{hasMore:t.payload});case"SAVE_ALL_COMMENTS":var a=e.posts.map((function(e){var a=Object(y.a)({},e);return a.id===t.payload.postId&&(a.lastComment=t.payload.comments),a}));return Object(y.a)(Object(y.a)({},e),{},{posts:a});case"SAVE_LAST_COMMENT":var n=e.posts.map((function(e){var a=Object(y.a)({},e);return a.id===t.payload.postId&&a.lastComment.push(t.payload.newComment),a}));return Object(y.a)(Object(y.a)({},e),{},{posts:n});case"DELETE_POSTS":return{hasMore:!0,posts:[],page:1,activePostDetails:null};case"ACTIVATE_POST":return Object(y.a)(Object(y.a)({},e),{},{activePostDetails:t.payload});case"DEL_ACTIVATE_POST":return Object(y.a)(Object(y.a)({},e),{},{activePostDetails:null});default:return e}},Qe={user_info:[],isLogin:!1,isAuth:localStorage.getItem("isAuth")||!1},Ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SEND_LOGIN":var a=Object.assign({},t.payload);return localStorage.setItem("isAuth",!0),{user_info:a,isLogin:!0};case"SEND_LOGOUT":return localStorage.removeItem("isAuth"),{session_id:null,user_info:[],isLogin:!1};case"SET_AVATAR":return Object(y.a)(Object(y.a)({},e),{},{user_info:Object(y.a)(Object(y.a)({},e.user_info),{},{image:t.payload})});default:return e}},et={active:!1,login:!1,register:!1,uploadPost:!1,uploadUserAvatar:!1,postDetails:!1},tt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CLOSE_ALL":return Object(y.a)({},t.payload);case"ACTIVE_REGISTER":return Object(y.a)(Object(y.a)({},e),{},{register:!0,active:!0});case"ACTIVE_LOGIN":return Object(y.a)(Object(y.a)({},e),{},{login:!0,active:!0});case"ACTIVE_UPLOAD_POST":return Object(y.a)(Object(y.a)({},e),{},{uploadPost:!0,active:!0});case"ACTIVE_UPLOAD_USER_AVATAR":return Object(y.a)(Object(y.a)({},e),{},{uploadUserAvatar:!0,active:!0});case"ACTIVE_POST_DETAILS":return Object(y.a)(Object(y.a)({},e),{},{postDetails:!0,active:!0});default:return e}},at={recomends_subs:[],user_subs:[],isLoadingRec:!0,isLoadingSub:!0},nt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:at,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_RECOMEND_SUBS":return Object(y.a)(Object(y.a)({},e),{},{recomends_subs:t.payload,isLoadingRec:!1});case"SAVE_SUBS":return Object(y.a)(Object(y.a)({},e),{},{user_subs:t.payload,isLoadingSub:!1});case"CLEAR_SUBS":return Object(y.a)({},at);default:return e}},ct=Object(Xe.c)({posts:Ke,user:Ze,modals:tt,subs:nt}),st=a(150),rt=Object(Xe.e)(ct,Object(Xe.d)(Object(Xe.a)(st.a),null));o.a.render(Object(n.jsx)(m.a,{store:rt,children:Object(n.jsx)(E.a,{children:Object(n.jsx)(Je,{})})}),document.getElementById("root"))}},[[290,1,2]]]);
//# sourceMappingURL=main.755e0a09.chunk.js.map